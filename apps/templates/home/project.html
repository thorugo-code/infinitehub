{% extends 'layouts/base.html' %} {% block title %} Project {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %} {% block content %}

    <div class="header bg-primary" style="padding-bottom: 14rem">
        <div class="container-fluid">
            <div class="header-body">
                <div class="row align-items-center py-4">
                    <div class="col-lg-6 col-7" style="margin-bottom: 2rem">
                        <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
                            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
                                <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
                                <li class="breadcrumb-item"><a href="/projects/">Projects</a></li>
                                <li class="breadcrumb-item active">{{ project.title }}</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Page Title -->
    <div class="pb-7" style="margin-top: -14rem">
        <div class="container-fluid">
            <div class="header-body">
                <div class="row" style="justify-content: center">
                    <a href="#" data-toggle="modal" data-target="#profilePictureModal" class="avatar card-profile-image"
                       style="z-index: 1; min-width: 120px; min-height: 120px; background-color: #adb5bd00">
                        <img class="rounded-circle mt-7"
                             style="max-width: 100%; height: 100%; object-fit: cover; background-color: #fff"
                             alt="Image placeholder" src="{{ project.img.url }}">
                    </a>
                    <div class="col-md-7 pl-5">
                        <h1 class="text-white pt-2 mb-0" style="font-size: 2.5rem">
                            <a target="_blank" class="text-white" style="line-height: 1rem">
                                {{ project.title }}
                            </a>
                        </h1>
                        <p class="text-lead text-light mt--2">
                            {% if project.client %}
                                <a target="_blank" class="text-white ml-1" aria-label="Client's name">{{ project.client.name }}</a>
                            {% elif project.client_str %}
                                <i class="text-white ml-1">"{{ project.client_str }}"</i>
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Page Widgets -->
    <div class="mt--6 pb-4"></div>
    <div class="container-fluid">
        <div class="row pb-4">
            <div class="col-xl-7">
                <form method="post" id="updateProject" action="{% url 'project_details' project.id %}">
                    {% csrf_token %}
                    <div class="card shadow">
                        <div class="pb-1">
                            <div class="card-header">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h3 class="mb-0">Info</h3>
                                    </div>
                                    {% if edit_mode %}
                                        <div class="col text-right">
                                            <button type="submit" class="btn btn-sm btn-success">Save
                                            </button>
                                        </div>
                                    {% else %}
                                        <div class="col text-right">
                                            <a href="?edit" class="btn btn-sm btn-neutral">
                                                <i class="fas fa-cog"></i>
                                            </a>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                            <!-- Card body -->
                            <div class="card-body" style="padding: 2rem">
                                {% if edit_mode %}
                                    <div class="row px-3">
                                        <div class="col-lg-6">
                                            <div class="form-group form-control-label">
                                                <label class="form-control-label" for="title">Title</label>
                                                <input type="text" id="title" name="title" class="form-control"
                                                       placeholder="Client's name" value="{{ project.title }}">
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="form-group form-control-label">
                                                <label for="client" class="form-control-label">Client</label>
                                                {% if edit_mode %}
                                                    <select class="form-control" id="client" name="client">
                                                        {% if not project.client and project.client_str %}
                                                            <option value="" disabled selected>{{ project.client.name|default:project.client_str|truncatechars:25 }}</option>
                                                        {% else %}
                                                            <option value=""></option>
                                                        {% endif %}
                                                        {% for client in clients %}
                                                            <option value="{{ client.id }}"
                                                                    {% if project.client == client %}selected{% endif %}>
                                                                {{ client.name }}
                                                            </option>
                                                        {% endfor %}
                                                    </select>
                                                {% else %}
                                                    <input type="text" id="client" name="client"
                                                           class="form-control"
                                                           placeholder="Client's name"
                                                           value="{{ project.client.name|default:project.client_str|truncatechars:25 }}"
                                                           disabled>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="px-3">
                                        <div class="form-group form-control-label mb-3 pb-1">
                                        <label for="choices-collaborators">
                                            Collaborators
                                        </label>
                                        <select id="choices-collaborators" name="collaborators-choice" multiple>
                                            {% for collaborator in collaborators %}
                                                <option value="{{ collaborator.id }}" {% if collaborator.user in project.assigned_to.all %}selected{% endif %}>{{ collaborator.user.get_full_name }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    </div>
                                {% else %}
                                    <div class="avatar-group pl-3 pb-4 align-items-center">
                                        {% for collaborator in project.assigned_to.all %}
                                            <a href="" class="avatar avatar-sm rounded-circle border-0"
                                               style="background-color: #fff;"
                                               data-toggle="tooltip" data-original-title="{{ collaborator.get_full_name }}">
                                                <div class="avatar avatar-sm rounded-circle">
                                                    <img style="max-width: 100%; height: 100%; object-fit: cover; background-color: #fff;"
                                                         alt="Image placeholder"
                                                         src="{{ collaborator.profile.avatar.url }}">
                                                </div>
                                            </a>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <div class="px-3">
                                    <div class="row">
                                        {% if edit_mode %}
                                            <div class="col-lg-4">
                                                <div class="form-group form-control-label">
                                                    <label for="input-date">Start:</label>
                                                    {% if edit_mode %}
                                                        <input type="date" id="input-date" class="form-control"
                                                               name="start_date"
                                                               value="{{ project.start_date|date:'Y-m-d' }}">
                                                    {% else %}
                                                        <input type="text" id="input-date" name="start_date"
                                                               class="form-control" placeholder="dd/mm/aaaa"
                                                               value="{{ project.start_date|date:'d/m/Y' }}"
                                                               disabled>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="form-group form-control-label">
                                                    <label for="input-address">Deadline:</label>
                                                    {% if edit_mode %}
                                                        <input type="date" id="input-date" class="form-control"
                                                               name="deadline"
                                                               value="{{ project.deadline|date:'Y-m-d' }}">
                                                    {% else %}
                                                        <input type="text" id="input-date" name="deadline"
                                                               class="form-control" placeholder="dd/mm/aaaa"
                                                               value="{{ project.deadline|date:'d/m/Y' }}"
                                                               disabled>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-lg-4 form-control-label">
                                                <label for="input-client-area">Country</label>
                                                <div class="form-group">
                                                    {% if edit_mode %}
                                                        <select class="form-control" , id="country" ,
                                                                name="country">
                                                            <option value="br"
                                                                    {% if project.country == 'br' %}selected{% endif %}>
                                                                Brazil
                                                            </option>
                                                            <option value="pt"
                                                                    {% if project.country == 'pt' %}selected{% endif %}>
                                                                Portugal
                                                            </option>
                                                        </select>
                                                    {% else %}
                                                        {% if project.country == "br" %}
                                                            <img src="/static/assets/img/icons/custom/1x/br.png"
                                                                 alt="br"
                                                                 style="height: 25px; margin-top: 0.5rem">
                                                        {% elif project.country == "pt" %}
                                                            <img src="/static/assets/img/icons/custom/1x/pt.png"
                                                                 alt="pt"
                                                                 style="height: 25px; margin-top: 0.5rem">
                                                        {% endif %}
                                                    {% endif %}
                                                </div>
                                            </div>
                                        {% else %}
                                            <div class="col-lg-5">
                                                <div class="form-group form-control-label">
                                                    <label for="input-date">Start:</label>
                                                    {% if edit_mode %}
                                                        <input type="date" id="input-date" class="form-control"
                                                               name="start_date"
                                                               value="{{ project.start_date|date:'Y-m-d' }}">
                                                    {% else %}
                                                        <input type="text" id="input-date" name="start_date"
                                                               class="form-control" placeholder="dd/mm/aaaa"
                                                               value="{{ project.start_date|date:'d/m/Y' }}"
                                                               disabled>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-lg-5">
                                                <div class="form-group form-control-label">
                                                    <label for="input-address">Deadline:</label>
                                                    {% if edit_mode %}
                                                        <input type="date" id="input-date" class="form-control"
                                                               name="deadline"
                                                               value="{{ project.deadline|date:'Y-m-d' }}">
                                                    {% else %}
                                                        <input type="text" id="input-date" name="deadline"
                                                               class="form-control" placeholder="dd/mm/aaaa"
                                                               value="{{ project.deadline|date:'d/m/Y' }}"
                                                               disabled>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div class="col-lg-2 form-control-label">
                                                <label for="input-client-area">Country</label>
                                                <div class="form-group">
                                                    {% if edit_mode %}
                                                        <select class="form-control" , id="country" ,
                                                                name="country">
                                                            <option value="br"
                                                                    {% if project.country == 'br' %}selected{% endif %}>
                                                                Brazil
                                                            </option>
                                                            <option value="pt"
                                                                    {% if project.country == 'pt' %}selected{% endif %}>
                                                                Portugal
                                                            </option>
                                                        </select>
                                                    {% else %}
                                                        {% if project.country == "br" %}
                                                            <img src="/static/assets/img/icons/custom/1x/br.png"
                                                                 alt="br"
                                                                 style="height: 25px; margin-top: 0.5rem">
                                                        {% elif project.country == "pt" %}
                                                            <img src="/static/assets/img/icons/custom/1x/pt.png"
                                                                 alt="pt"
                                                                 style="height: 25px; margin-top: 0.5rem">
                                                        {% endif %}
                                                    {% endif %}
                                                </div>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="px-3">
                                    <div class="form-group form-control-label">
                                        <label for="about">About</label>
                                        {% if edit_mode %}
                                            <textarea rows="6" class="form-control" id="about" name="about"
                                                      placeholder="A few words about the project ...">{{ project.about }}</textarea>
                                        {% else %}
                                            <textarea rows="6" class="form-control" id="about" name="about"
                                                      placeholder="A few words about the project ..."
                                                      disabled>{{ project.about }}</textarea>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="card shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h3 class="mb-0">Links</h3>
                            </div>
                            <div class="col text-right">
                                <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"
                                   data-target="#newLinkModal">
                                    <i class="fas fa-plus"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0" style="min-height: 4rem; max-height: 11rem; overflow-y: auto;">
                        <ul class="list-group list-group-flush">
                            {% for link in project.links.all %}
                                <li class="list-group-item flex-column align-items-start py-3 px-4 border-bottom-0">
                                    <div class="row align-items-center">
                                        <div class="col-auto pr-1">
                                            <img src="{{ link.icon }}"
                                                 alt="Website"
                                                 style="height: 18px">
                                        </div>
                                        <div class="col">
                                            <a href="{{ link.path }}" target="_blank"
                                               class="text-default font-weight-light h4">{{ link.title|truncatechars:50 }}</a>
                                        </div>
                                        <div class="col-auto text-right">
                                            <a href="{{ link.path }}" target="_blank"
                                               class="font-weight-light" style="font-size: 0.8125rem">
                                                <i class="fas fa-link"></i>
                                            </a>
                                            <a href="#" data-toggle="modal" data-target="#deleteLinkConfirm{{ link.id }}"
                                               class="font-weight-light ml-2" style="font-size: 0.8125rem">
                                                <i class="fas fa-times text-danger"></i>
                                            </a>
                                        </div>
                                    </div>
                                </li>
                                
                                <!-- Delete Link Confirm Modal -->
                                <div class="modal fade" id="deleteLinkConfirm{{ link.id }}"
                                     tabindex="-1" role="dialog"
                                     aria-labelledby="deleteLinkConfirmLabel{{ task.id }}"
                                     aria-hidden="true">
                                    <div class="modal-dialog my-6" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header mt-2">
                                                <h5 class="modal-title my-1"
                                                    style="margin-left: auto">
                                                    <i class="ni ni-fat-delete text-blue"
                                                       style="font-size: 1.5rem; margin-top: 0.15rem !important"></i>
                                                </h5>
                                                <span class="ml-3 my-1"
                                                      style="margin-right: auto; font-size: 1.2rem"
                                                      id="deleteTaskConfirmModalLabel">Are you sure?</span>
                                                <button type="button" class="close mt--4"
                                                        style="margin-left: -30px"
                                                        data-dismiss="modal"
                                                        aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body pb-0"
                                                 style="padding-left: 2.5rem; padding-right: 2.5rem">
                                                <form method="post"
                                                      id="deleteLinkConfirmForm{{ link.id }}"
                                                      action="{% url 'delete_link' project.id link.id %}">
                                                    {% csrf_token %}
                                                    <div class="form-group">
                                                        <p class="text-center">Are you sure you want to delete this link?
                                                            <br>
                                                            <i>"{{ link.title|default:link.path }}"</i>
                                                            <br>
                                                            This action cannot be undone.
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Cancel
                                                </button>
    
                                                <button type="submit" class="btn btn-danger"
                                                        form="deleteLinkConfirmForm{{ link.id }}">
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="card-footer py-1" style="border-top: 0 !important"></div>
                </div>
            </div>
            <div class="col-xl-5" style="max-height: 824px">
                <div class="card shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h3 class="mb-0">Files </h3>
                            </div>
                            <div class="col text-right">
                                {#                                    <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"#}
                                {#                                       data-target="#sortModal">#}
                                {#                                        <i class="fas fa-sort"></i>#}
                                {#                                    </a>#}
                                {#                                    <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"#}
                                {#                                       data-target="#filterModal">#}
                                {#                                        <i class="fas fa-filter"></i>#}
                                {#                                    </a>#}
                                <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"
                                   data-target="#newFileModal">
                                    <i class="fas fa-plus"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <!-- Card body (ADD CONTENT) -->
                    <div class="card-body px-4 pb-4 pt-0">
                        <div class="file-list" style="height: 200px">

                            {% load filters %}

                            {% for uploaded_file in project.uploaded_files.all %}
                                <div class="file-item mr-3" style="height: 105px">
                                    <a href="#"
                                       data-toggle="modal"
                                       data-target="#watchFileModal{{ uploaded_file.pk }}">
                                        <img src="/static/assets/img/icons/extensions/1x/{{ uploaded_file.file.name|file_extension_icon }}"
                                             alt="{{ uploaded_file.file.name }}" style="height: 105px">
                                    </a>
                                    <div style="width: 94.27px">
                                        <div style="display: flex; justify-content: center">
                                            <a
                                                    href="#"
                                                    data-toggle="modal"
                                                    data-target="#watchFileModal">{{ uploaded_file.file|file_name_only_with_extension|truncatechars:10 }}
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <!-- Watch File Modal -->
                                <div class="modal fade" id="watchFileModal{{ uploaded_file.pk }}"
                                     tabindex="-1" role="dialog"
                                     aria-labelledby="watchFileModalLabel{{ uploaded_file.pk }}"
                                     aria-hidden="true">
                                    <div class="modal-dialog my-6" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header mt-2 mb--1">
                                                <h5 class="modal-title my-1"
                                                    style="margin-left: auto">
                                                    <i></i>
                                                </h5>
                                                <span class="ml-3 my-1"
                                                      style="margin-right: auto; font-size: 1.2rem"
                                                      id="newPageModalLabel"></span>
                                                <button type="button" class="close mt--4"
                                                        style="margin-left: -30px"
                                                        data-dismiss="modal"
                                                        aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body py-0"
                                                 style="padding-left: 2.5rem; padding-right: 2.5rem">
                                                <form method="post"
                                                      id="downloadFile{{ uploaded_file.pk }}"
                                                      action="{% url 'delete_file' project.id uploaded_file.pk %}">
                                                    {% csrf_token %}
                                                    <div class="form-group mt--1"
                                                         style="display: flex; justify-content: center">
                                                        <img
                                                                id="filePreviewModal"
                                                                src="/static/assets/img/icons/extensions/1x/{{ uploaded_file.file.name|file_extension_icon }}"
                                                                alt="New File"
                                                                style="height: 130px"/>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group form-control-label col-sm-9">
                                                            <label for="fileType"
                                                                   style="font-size:0.8125rem; font-weight:600">Name</label>
                                                            <input type="text" class="form-control"
                                                                   id="fileType"
                                                                   value="{{ uploaded_file.file.name|file_name_only_with_extension }}"
                                                                   disabled>
                                                        </div>
                                                        <div class="form-group form-control-label col-sm-3">
                                                            <label for="fileSize"
                                                                   style="font-size:0.8125rem; font-weight:600">Size</label>
                                                            <input type="text" class="form-control" id="fileSize"
                                                                   value="{{ uploaded_file.file.size|filesizeformat }}"
                                                                   disabled>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group form-control-label col-sm-4">
                                                            <label for="fileUploadUser"
                                                                   style="font-size:0.8125rem; font-weight:600">Uploaded
                                                                By</label>
                                                            <input type="text" class="form-control"
                                                                   id="fileUploadUser"
                                                                   value="{{ uploaded_file.uploaded_by.first_name }} {{ uploaded_file.uploaded_by.last_name }}"
                                                                   disabled>
                                                        </div>
                                                        <div class="form-group form-control-label col-sm-4">
                                                            <label for="fileType"
                                                                   style="font-size:0.8125rem; font-weight:600">Category</label>
                                                            <input type="text" class="form-control"
                                                                   id="fileType"
                                                                   value="{{ uploaded_file.category|refformatted_category }}"
                                                                   disabled>
                                                        </div>
                                                        <div class="form-group form-control-label col-sm-4">
                                                            <label for="fileUploadDate"
                                                                   style="font-size:0.8125rem; font-weight:600">Date</label>
                                                            <input type="date" class="form-control"
                                                                   id="fileUploadDate"
                                                                   value="{{ uploaded_file.uploaded_at|date:'Y-m-d' }}"
                                                                   disabled>
                                                        </div>
                                                    </div>
                                                    <div class="form-group form-control-label">
                                                        <label for="fileDescription"
                                                               style="font-size:0.8125rem; font-weight:600">Description</label>
                                                        <textarea class="form-control"
                                                                  id="fileDescription"
                                                                  disabled>{{ uploaded_file.description }}</textarea>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Cancel
                                                </button>
                                                <button class="btn btn-danger text-white"
                                                        data-dismiss="modal" data-toggle="modal"
                                                        data-target="#deleteConfirm{{ uploaded_file.pk }}">
                                                    Delete
                                                </button>
                                                <a href="{% url 'download_file' uploaded_file.pk %}"
                                                   class="btn btn-success">Download</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Delete Confirm Modal -->
                                <div class="modal fade" id="deleteConfirm{{ uploaded_file.pk }}"
                                     tabindex="-1" role="dialog"
                                     aria-labelledby="deleteConfirmLabel{{ uploaded_file.pk }}"
                                     aria-hidden="true">
                                    <div class="modal-dialog my-6" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header mt-2">
                                                <h5 class="modal-title my-1"
                                                    style="margin-left: auto">
                                                    <i class="ni ni-fat-delete text-blue"
                                                       style="font-size: 1.5rem; margin-top: 0.15rem !important"></i>
                                                </h5>
                                                <span class="ml-3 my-1"
                                                      style="margin-right: auto; font-size: 1.2rem"
                                                      id="deleteConfirmModalLabel">Are you sure?</span>
                                                <button type="button" class="close mt--4"
                                                        style="margin-left: -30px"
                                                        data-dismiss="modal"
                                                        aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body py-0"
                                                 style="padding-left: 2.5rem; padding-right: 2.5rem">
                                                <form method="post"
                                                      id="deleteConfirmForm{{ uploaded_file.pk }}"
                                                      action="{% url 'delete_file' project.id uploaded_file.pk %}">
                                                    {% csrf_token %}
                                                    <div class="form-group mt-4"
                                                         style="display: flex; justify-content: center">
                                                        <img
                                                                id="filePreviewModal"
                                                                src="/static/assets/img/icons/extensions/1x/{{ uploaded_file.file.name|file_extension_icon }}"
                                                                alt="New File"
                                                                style="height: 130px"/>
                                                    </div>
                                                    <div class="form-group form-control-label">
                                                        <label for="fileName"
                                                               style="font-size:0.8125rem; font-weight:600">Name</label>
                                                        <input type="text" class="form-control"
                                                               id="fileUploadDate"
                                                               value="{{ uploaded_file.file|file_name_only_with_extension }}"
                                                               disabled>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Cancel
                                                </button>

                                                <button type="submit" class="btn btn-danger"
                                                        form="deleteConfirmForm{{ uploaded_file.pk }}">
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="card shadow">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="col">
                                <h3 class="mb-0">Tasks</h3>
                            </div>
                            <div class="col text-right">
                                {# <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"#}
                                {#    data-target="#sortTasksModal">#}
                                {#     <i class="fas fa-sort"></i>#}
                                {# </a>#}
                                {# <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"#}
                                {#    data-target="#filterTasksModal">#}
                                {#     <i class="fas fa-filter"></i>#}
                                {# </a>#}
                                <a href="#" class="btn btn-sm btn-neutral" data-toggle="modal"
                                   data-target="#newTaskModal">
                                    <i class="fas fa-plus"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0" style="min-height: 85px; max-height: 24rem; overflow-y: auto;">
                        <ul class="list-group list-group-flush" data-toggle="checklist">
                            {% for task in tasks %}
                                <li class="checklist-entry list-group-item flex-column align-items-start py-3 px-4 border-bottom-0">
                                    <div class="checklist-item {% if task.priority == 1 %} 
                                    checklist-item-success {% elif task.priority == 2 %} 
                                    checklist-item-medium {% elif task.priority == 3 %}
                                    checklist-item-danger {% else %} checklist-item-info {% endif %}{% if task.completed %}
                                    checklist-item-checked{% endif %}">
                                        <a href="#" data-toggle="modal" data-target="#taskDetails{{ task.id }}">
                                            <div class="checklist-info">
                                                <h5 class="checklist-title mb-0 {% if not task.completed and task.deadline|time_to_date < 0 %}text-danger{% endif %}">{{ task.title }}</h5>
                                                <small class="{% if task.priority == 1 %}
                                                text-success {% elif task.priority == 2 %} 
                                                text-medium {% elif task.priority == 3 %}
                                                text-danger {% else %} text-info {% endif %}">
                                                    {% if task.priority == 1 %}
                                                        Low {% elif task.priority == 2 %} 
                                                        Medium {% elif task.priority == 3 %}
                                                        High {% else %} 
                                                        None
                                                    {% endif %}
                                                </small>
                                                <small class="text-nowrap {% if not task.completed and task.deadline|time_to_date < 0 %}text-danger{% else %}text-default{% endif %}">
                                                - {{ task.deadline|date:'d/m/Y' }}
                                                </small>
                                            </div>
                                        </a>
                                        <div>
                                            <div class="custom-control custom-checkbox {% if task.priority == 1 %}
                                            custom-checkbox-success {% elif task.priority == 2 %}
                                            custom-checkbox-medium {% elif task.priority == 3 %}
                                            custom-checkbox-danger {% else %} 
                                            custom-checkbox-info {% endif %}">
                                                <form method="post" id="changeStatusTask{{ task.id }}"
                                                      action="{% url 'change_task_status' project.id task.id %}">
                                                    {% csrf_token %}
                                                    <label class="custom-control custom-checkbox">
                                                        <input class="custom-control-input"
                                                               id="chk-todo-task-{{ task.id }}"
                                                               type="checkbox"
                                                               {% if task.completed %}checked{% endif %}
                                                               onchange="submitCheckboxForm({{ task.id }})">
                                                        <label class="custom-control-label"
                                                               for="chk-todo-task-{{ task.id }}"></label>
                                                    </label>
                                                </form>

                                            </div>
                                        </div>
                                    </div>
                                </li>

                                <!-- Task Details Modal -->
                                <div class="modal fade" id="taskDetails{{ task.id }}" tabindex="-1" role="dialog"
                                     aria-labelledby="taskDetails{{ task.id }}Label" aria-hidden="true">
                                    <div class="modal-dialog my-6" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header mt-2 align-items-center">
                                                <h5 class="modal-title my-1" style="margin-left: auto">
                                                    <i class="fas fa-circle {% if task.priority == 1 %}
                                                    text-success{% elif task.priority == 2 %}
                                                    text-medium{% elif task.priority == 3 %}
                                                    text-danger{% else %}
                                                    text-info{% endif %}"
                                                       style="font-size: 0.9rem">
                                                    </i>
                                                </h5>
                                                <span class="ml-3 my-1 {% if not task.completed and task.deadline|time_to_date < 0 %}text-danger{% endif %}"
                                                      style="margin-right: auto; font-size: 1.2rem"
                                                      id="newFileModalLabel">{{ task.title|truncatechars:'30' }}</span>
                                                <button type="button" class="close mt--4" style="margin-left: -30px"
                                                        data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body py-0"
                                                 style="padding-left: 2.5rem; padding-right: 2.5rem">
                                                <form method="post" id="editTask{{ task.id }}"
                                                      action="{% url 'edit_task' project.id task.id %}"
                                                      onsubmit="disableSubmitTaskButton()">
                                                    {% csrf_token %}
                                                    <div class="row">
                                                        <div class="form-group form-control-label col-sm">
                                                            <label for="taskTitleEdit">Title</label>
                                                            <input type="text" class="form-control"
                                                                   id="taskTitleEdit"
                                                                   name="taskTitleEdit" placeholder=""
                                                                   value="{{ task.title }}">
                                                        </div>
                                                        <div class="form-group form-control-label col-sm-4">
                                                            <label for="taskPriorityInputEdit">Priority</label>
                                                            <select class="form-control" id="taskPriorityInputEdit"
                                                                    name="taskPriorityEdit">
                                                                <option value="0"></option>
                                                                <option value="3"
                                                                        {% if task.priority == 3 %}selected{% endif %}>
                                                                    High
                                                                </option>
                                                                <option value="2"
                                                                        {% if task.priority == 2 %}selected{% endif %}>
                                                                    Medium
                                                                </option>
                                                                <option value="1"
                                                                        {% if task.priority == 1 %}selected{% endif %}>
                                                                    Low
                                                                </option>
                                                                <option value="0"
                                                                        {% if task.priority == 0 %}selected{% endif %}>
                                                                    None
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group form-control-label col-sm-6">
                                                            <label for="taskDeadlineEdit">Deadline</label>
                                                            <input type="date" class="form-control {% if not task.completed and task.deadline|time_to_date < 0 %}text-danger{% endif %}"
                                                                   id="taskDeadlineEdit"
                                                                   name="taskDeadlineEdit" placeholder=""
                                                                   onchange="enableSubmitTaskButton()"
                                                                   onemptied="disableSubmitTaskButton()"
                                                                   value="{{ task.deadline|date:"Y-m-d" }}">
                                                        </div>
                                                        <div class="form-group form-control-label col-sm-6">
                                                            <label for="taskOwnerEditInput">Owner</label>
                                                            <select class="form-control" id="taskOwnerEditInput" name="taskOwnerEdit">
                                                                <option value=""></option>
                                                                {% for collab in collaborators %}
                                                                    {% if collab.user.username != 'admin@infinitefoundry.com' %}
                                                                        <option value="{{ collab.user.id }}" {% if task.owner == collab.user %}selected{% endif %}>{{ collab.user.get_full_name }}</option>
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="form-group mb-2 form-control-label">
                                                        <label for="taskDescriptionEdit">Description</label>
                                                        <textarea class="form-control"
                                                                  id="taskDescriptionEdit"
                                                                  name="taskDescriptionEdit"
                                                                  rows="3">{{ task.description }}</textarea>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                                        form="editTask{{ task.id }}" id="cancelEditTaskButton">
                                                    Cancel
                                                </button>
                                                <a class="btn btn-danger"
                                                   href="#" data-dismiss="modal" data-toggle="modal" data-target="#deleteTaskConfirm{{ task.id }}">
                                                    Delete
                                                </a>
                                                <button type="submit" class="btn btn-success"
                                                        form="editTask{{ task.id }}"
                                                        id="editTaskButton">
                                                    Save
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Delete Task Confirm Modal -->
                                <div class="modal fade" id="deleteTaskConfirm{{ task.id }}"
                                     tabindex="-1" role="dialog"
                                     aria-labelledby="deleteTaskConfirmLabel{{ task.id }}"
                                     aria-hidden="true">
                                    <div class="modal-dialog my-6" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header mt-2">
                                                <h5 class="modal-title my-1"
                                                    style="margin-left: auto">
                                                    <i class="ni ni-fat-delete text-blue"
                                                       style="font-size: 1.5rem; margin-top: 0.15rem !important"></i>
                                                </h5>
                                                <span class="ml-3 my-1"
                                                      style="margin-right: auto; font-size: 1.2rem"
                                                      id="deleteTaskConfirmModalLabel">Are you sure?</span>
                                                <button type="button" class="close mt--4"
                                                        style="margin-left: -30px"
                                                        data-dismiss="modal"
                                                        aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body pb-0"
                                                 style="padding-left: 2.5rem; padding-right: 2.5rem">
                                                <form method="post"
                                                      id="deleteTaskConfirmForm{{ task.id }}"
                                                      action="{% url 'delete_task' project.id task.id %}">
                                                    {% csrf_token %}
                                                    <div class="form-group">
                                                        <p class="text-center">Are you sure you want to delete this task?
                                                            <br>
                                                            <i>"{{ task.title }}"</i>
                                                            <br>
                                                            This action cannot be undone.
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                        data-dismiss="modal">Cancel
                                                </button>

                                                <button type="submit" class="btn btn-danger"
                                                        form="deleteTaskConfirmForm{{ task.id }}">
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            {% endfor %}
                        </ul>
                    </div>
                    <div class="card-footer py-1" style="border-top: 0 !important"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="container-fluid mt--4">
        {% include "includes/footer.html" %}
    </div>

    <!-- Profile Picture Modal -->
    <div class="modal fade" id="profilePictureModal" tabindex="-1" role="dialog"
         aria-labelledby="profilePictureModalLabel" aria-hidden="true">
        <div class="modal-dialog my-6" role="document">
            <div class="modal-content">
                <div class="modal-header mt-2">
                    <h5 class="modal-title my-1" style="margin-left: auto">
                        <i class="ni ni-image text-blue" style="font-size: 1.5rem"></i>
                    </h5>
                    <span class="ml-3 my-1" style="margin-right: auto; font-size: 1.2rem"
                          id="profilePictureModalLabel">{{ project.title }}</span>
                    <button type="button" class="close mt--4" style="margin-left: -30px"
                            data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body py-0" style="padding-left: 2.5rem; padding-right: 2.5rem">
                    <form id="profilePictureForm" method="post"
                          action="{% url 'change_picture' project.id %}" enctype="multipart/form-data"
                          onsubmit="disableButtons()">
                        {% csrf_token %}
                        <div class="form-group mt-7 mb-0"
                             style="display: flex; justify-content: center">
                            <div class="avatar card-profile-image"
                                 style="z-index: 1; width: 200px; height: 200px; background-color: #adb5bd00">
                                <img
                                        id="imagePreviewModal"
                                        class="rounded-circle mt-7"
                                        style="max-width: 100%; height: 100%; object-fit: cover;"
                                        alt="Image placeholder"
                                        src="{{ project.img.url }}">
                            </div>
                        </div>
                        <div class="form-group form-control-label">
                            <label for="fileInput">Select file</label>
                            <input type="file" class="form-control-file" id="fileInput"
                                   name="projectPicture"
                                   accept="image/*"
                                   onchange="previewImage(event); enableButtons()">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            id="cancelButton">Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" form="profilePictureForm"
                            id="uploadButton" disabled>Upload
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Task Modal -->
    <div class="modal fade" id="newTaskModal" tabindex="-1" role="dialog"
         aria-labelledby="newTaskModalLabel" aria-hidden="true">
        <div class="modal-dialog my-6" role="document">
            <div class="modal-content">
                <div class="modal-header mt-2 align-items-center">
                    <h5 class="modal-title my-1" style="margin-left: auto">
                        <i class="fas fa-tasks text-blue"
                           style="font-size: 1.2rem"></i>
                    </h5>
                    <span class="ml-3 my-1"
                          style="margin-right: auto; font-size: 1.2rem"
                          id="newFileModalLabel">New task</span>
                    <button type="button" class="close mt--4" style="margin-left: -30px"
                            data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body py-0"
                     style="padding-left: 2.5rem; padding-right: 2.5rem">
                    <form method="post" id="submitTask"
                          action="{% url 'submit_task' project.id %}"
                          onsubmit="disableSubmitTaskButton()">
                        {% csrf_token %}
                        <div class="row">
                            <div class="form-group form-control-label col">
                                <label for="taskTitle">Title</label>
                                <input type="text" class="form-control"
                                       id="taskTitle"
                                       name="taskTitle" placeholder="">
                            </div>
                            <div class="form-group form-control-label col-4">
                                <label for="taskPriorityInput">Priority</label>
                                <select class="form-control" id="taskPriorityInput" name="taskPriority">
                                    <option value="0"></option>
                                    <option value="3">High</option>
                                    <option value="2">Medium</option>
                                    <option value="1">Low</option>
                                    <option value="0">None</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group form-control-label col">
                                <label for="taskDeadline">Deadline</label>
                                <input type="date" class="form-control"
                                       id="taskDeadline"
                                       name="taskDeadline" placeholder=""
                                       onchange="enableSubmitTaskButton()"
                                       onemptied="disableSubmitTaskButton()">
                            </div>
                            <div class="form-group form-control-label col">
                                <label for="taskOwnerInput">Owner</label>
                                <select class="form-control" id="taskOwnerInput" name="taskOwner">
                                    <option value=""></option>
                                    {% for collab in collaborators %}
                                        {% if collab.user.username != 'admin@infinitefoundry.com' %}
                                            <option value="{{ collab.user.id }}">{{ collab.user.get_full_name }}</option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-2 form-control-label">
                            <label for="taskDescription">Description</label>
                            <textarea class="form-control"
                                      id="taskDescription"
                                      name="taskDescription" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            form="submitTask" id="cancelTaskButton">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" form="submitTask"
                            id="submitTaskButton" disabled>
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Link Modal -->
    <div class="modal fade" id="newLinkModal" tabindex="-1" role="dialog"
         aria-labelledby="newLinkModalLabel" aria-hidden="true">
        <div class="modal-dialog my-6" role="document">
            <div class="modal-content">
                <div class="modal-header mt-2 align-items-center">
                    <h5 class="modal-title my-1" style="margin-left: auto">
                        <i class="fas fa-link text-blue"
                           style="font-size: 1.2rem"></i>
                    </h5>
                    <span class="ml-3 my-1"
                          style="margin-right: auto; font-size: 1.2rem"
                          id="newFileModalLabel">New Link</span>
                    <button type="button" class="close mt--4" style="margin-left: -30px"
                            data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body py-0"
                     style="padding-left: 2.5rem; padding-right: 2.5rem">
                    <form method="post" id="submitLink" action="{% url 'add_link' project.id %}">
                        {% csrf_token %}
                        <div class="form-group form-control-label">
                            <label for="linkTitle">Title</label>
                            <input type="text" class="form-control"
                                   id="linkTitle"
                                   name="linkTitle" placeholder="">
                        </div>
                        <div class="form-group form-control-label">
                            <label for="linkURL">URL</label>
                            <input type="text" class="form-control"
                                   id="linkURL"
                                   name="linkURL" placeholder="">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            form="submitTask" id="cancelTaskButton">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" form="submitLink"
                            id="submitLinkButton">
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New File Modal -->
    <div class="modal fade" id="newFileModal" tabindex="-1" role="dialog"
         aria-labelledby="newFileModalLabel" aria-hidden="true">
        <div class="modal-dialog my-6" role="document">
            <div class="modal-content">
                <div class="modal-header mt-2">
                    <h5 class="modal-title my-1" style="margin-left: auto">
                        <i class="ni ni-cloud-upload-96 text-blue"
                           style="font-size: 1.5rem; margin-top: 0.15rem !important"></i>
                    </h5>
                    <span class="ml-3 my-1"
                          style="margin-right: auto; font-size: 1.2rem"
                          id="newFileModalLabel">Upload</span>
                    <button type="button" class="close mt--4" style="margin-left: -30px"
                            data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body py-0"
                     style="padding-left: 2.5rem; padding-right: 2.5rem">
                    <form method="post" id="uploadFile"
                          action="{% url 'upload_file' project.id %}"
                          enctype="multipart/form-data" onsubmit="disableButtonsFile()">
                        {% csrf_token %}
                        <div class="form-group mt-4"
                             style="display: flex; justify-content: center">
                            <img id="filePreviewModalImage"
                                 src="/static/assets/img/icons/extensions/1x/new.png"
                                 alt="New File"
                                 style="height: 130px"/>
                        </div>
                        <div class="form-group form-control-label">
                            <label for="fileInput">Select file</label>
                            <input type="file" name="file" class="form-control-file"
                                   id="fileInput"
                                   onchange="previewExtension(event); enableButtonsFile(); updateCategory(event)">
                        </div>
                        <div class="form-group form-control-label">
                            <label for="fileType">Category</label>
                            <select class="form-control" id="fileCategoryInput" name="file_type">
                                <option value="none">--Select--</option>
                                <option value="3d-models">3D Model</option>
                                <option value="scripts">Script</option>
                                <option value="unity">Unity</option>
                                <option value="clouds">Cloud</option>
                                <option value="executable">Executable</option>
                                <option value="folders">Folder</option>
                                <option value="database">Database</option>
                                <option value="office">Office</option>
                                <option value="images">Image</option>
                                <option value="video">Video</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group form-control-label">
                            <label for="fileValueInput">Value</label>
                            <input inputmode="decimal" class="form-control"
                                   id="fileValueInput"
                                   name="file_value" placeholder="">
                        </div>
                        <div class="form-group mb-2 form-control-label">
                            <label for="fileDescription">Description</label>
                            <textarea class="form-control"
                                      id="fileDescription"
                                      name="file_description"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                            form="uploadFile" id="cancelButtonFile">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-primary" form="uploadFile"
                            id="uploadButtonFile" disabled>
                        Upload
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Filter Modal -->
{#    <div class="modal fade" id="filterModal" tabindex="-1" role="dialog"#}
{#         aria-labelledby="filterModalLabel" aria-hidden="true">#}
{#        <div class="modal-dialog my-6" role="document">#}
{#            <div class="modal-content">#}
{#                <div class="modal-header mt-2 align-items-center">#}
{#                    <h5 class="modal-title" style="margin-left: auto">#}
{#                        <i class="ni ni-ui-04 text-blue" style="font-size: 1.5rem"></i>#}
{#                    </h5>#}
{#                    <span class="ml-3 my-1" style="margin-right: auto; font-size: 1.2rem"#}
{#                          id="filterModalLabel">Filter</span>#}
{#                    <button type="button" class="close mt--4" style="margin-left: -30px"#}
{#                            data-dismiss="modal" aria-label="Close">#}
{#                        <span aria-hidden="true">&times;</span>#}
{#                    </button>#}
{#                </div>#}
{#                <div class="modal-body py-0" style="padding-left: 2.5rem; padding-right: 2.5rem">#}
{##}
{#                </div>#}
{#                <div class="modal-footer">#}
{#                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>#}
{#                    <button type="submit" class="btn btn-primary" id="filterButton"#}
{#                            disabled>Filter#}
{#                    </button>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}

    <!-- Sort Modal -->
{#    <div class="modal fade" id="sortModal" tabindex="-1" role="dialog"#}
{#         aria-labelledby="sortModalLabel" aria-hidden="true">#}
{#        <div class="modal-dialog my-6" role="document">#}
{#            <div class="modal-content">#}
{#                <div class="modal-header mt-2 align-items-center">#}
{#                    <h5 class="modal-title" style="margin-left: auto">#}
{#                        <i class="ni ni-bullet-list-67 text-blue" style="font-size: 1.4rem"></i>#}
{#                    </h5>#}
{#                    <span class="ml-3 my-1" style="margin-right: auto; font-size: 1.2rem"#}
{#                          id="sortModalLabel">Sort</span>#}
{#                    <button type="button" class="close mt--4" style="margin-left: -30px"#}
{#                            data-dismiss="modal" aria-label="Close">#}
{#                        <span aria-hidden="true">&times;</span>#}
{#                    </button>#}
{#                </div>#}
{#                <div class="modal-body py-0" style="padding-left: 2.5rem; padding-right: 2.5rem">#}
{##}
{#                </div>#}
{#                <div class="modal-footer">#}
{#                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>#}
{#                    <button type="submit" class="btn btn-primary" id="sortButton"#}
{#                            disabled>Sort#}
{#                    </button>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}
{#    </div>#}

{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}

    <script src="/static/assets/vendor/clipboard/dist/clipboard.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/5.0.6/jquery.inputmask.min.js"></script>

    <script>

        function previewImage(event) {
            const preview = document.getElementById('imagePreviewModal');
            const fileInput = event.target;

            if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    preview.src = e.target.result;
                }

                reader.readAsDataURL(fileInput.files[0]);
            }
        }

        function previewExtension(event) {
            const preview = document.getElementById('filePreviewModalImage');
            const fileInput = event.target;

            if (fileInput.files && fileInput.files[0]) {
                const file = fileInput.files[0];
                const extension = file.name.split('.').pop().toLowerCase();

                // Define a mapping of file extensions to image URLs
                const extensionImageMap = {
                    'rvt': '/static/assets/img/icons/extensions/1x/rvt.png',
                    'stp': '/static/assets/img/icons/extensions/1x/stp.png',
                    'igs': '/static/assets/img/icons/extensions/1x/igs.png',
                    'ifc': '/static/assets/img/icons/extensions/1x/ifc.png',
                    'sat': '/static/assets/img/icons/extensions/1x/sat.png',
                    'dxf': '/static/assets/img/icons/extensions/1x/dxf.png',
                    'dwg': '/static/assets/img/icons/extensions/1x/dwg.png',
                    'prt': '/static/assets/img/icons/extensions/1x/prt.png',
                    'catpart': '/static/assets/img/icons/extensions/1x/catpart.png',
                    'catproduct': '/static/assets/img/icons/extensions/1x/catproduct.png',
                    'cgr': '/static/assets/img/icons/extensions/1x/cgr.png',
                    'obj': '/static/assets/img/icons/extensions/1x/obj.png',
                    'stl': '/static/assets/img/icons/extensions/1x/stl.png',
                    'jt': '/static/assets/img/icons/extensions/1x/jt.png',
                    'dgn': '/static/assets/img/icons/extensions/1x/dgn.png',
                    'fbx': '/static/assets/img/icons/extensions/1x/fbx.png',
                    'sldprt': '/static/assets/img/icons/extensions/1x/sldprt.png',
                    'sldasm': '/static/assets/img/icons/extensions/1x/sldasm.png',
                    'rcp': '/static/assets/img/icons/extensions/1x/rcp.png',
                    'rcs': '/static/assets/img/icons/extensions/1x/rcs.png',
                    'pod': '/static/assets/img/icons/extensions/1x/pod.png',
                    'fls': '/static/assets/img/icons/extensions/1x/fls.png',
                    'las': '/static/assets/img/icons/extensions/1x/las.png',
                    'e57': '/static/assets/img/icons/extensions/1x/e57.png',
                    'py': '/static/assets/img/icons/extensions/1x/py.png',
                    'html': '/static/assets/img/icons/extensions/1x/html.png',
                    'css': '/static/assets/img/icons/extensions/1x/css.png',
                    'js': '/static/assets/img/icons/extensions/1x/js.png',
                    'cs': '/static/assets/img/icons/extensions/1x/cs.png',
                    'c': '/static/assets/img/icons/extensions/1x/c.png',
                    'cpp': '/static/assets/img/icons/extensions/1x/cpp.png',
                    'json': '/static/assets/img/icons/extensions/1x/json.png',
                    'xml': '/static/assets/img/icons/extensions/1x/xml.png',
                    'kt': '/static/assets/img/icons/extensions/1x/kt.png',
                    'kts': '/static/assets/img/icons/extensions/1x/kts.png',
                    'exe': '/static/assets/img/icons/extensions/1x/exe.png',
                    'zip': '/static/assets/img/icons/extensions/1x/zip.png',
                    'rar': '/static/assets/img/icons/extensions/1x/rar.png',
                    'assets': '/static/assets/img/icons/extensions/1x/assets.png',
                    'asset': '/static/assets/img/icons/extensions/1x/assets.png',
                    'ress': '/static/assets/img/icons/extensions/1x/ress.png',
                    'sqlite3': '/static/assets/img/icons/extensions/1x/sqlite3.png',
                    'xlsx': '/static/assets/img/icons/extensions/1x/xlsx.png',
                    'docx': '/static/assets/img/icons/extensions/1x/docx.png',
                    'pptx': '/static/assets/img/icons/extensions/1x/pptx.png',
                    'pdf': '/static/assets/img/icons/extensions/1x/pdf.png',
                    'ai': '/static/assets/img/icons/extensions/1x/ai.png',
                    'jpg': '/static/assets/img/icons/extensions/1x/jpg.png',
                    'jpeg': '/static/assets/img/icons/extensions/1x/jpeg.png',
                    'png': '/static/assets/img/icons/extensions/1x/png.png',
                    'gif': '/static/assets/img/icons/extensions/1x/gif.png',
                    'webp': '/static/assets/img/icons/extensions/1x/webp.png',
                    'ico': '/static/assets/img/icons/extensions/1x/ico.png',
                    'mp4': '/static/assets/img/icons/extensions/1x/mp4.png',
                    'avi': '/static/assets/img/icons/extensions/1x/avi.png',
                    'mkv': '/static/assets/img/icons/extensions/1x/mkv.png',
                    'wmv': '/static/assets/img/icons/extensions/1x/wmv.png',
                    'txt': '/static/assets/img/icons/extensions/1x/txt.png',
                    'x_t': '/static/assets/img/icons/extensions/1x/x_t.png',
                    'x_b': '/static/assets/img/icons/extensions/1x/x_b.png',
                    'apk': '/static/assets/img/icons/extensions/1x/apk.png',
                    // Add more extensions and URLs as needed
                };

                // Check if there's a corresponding image URL for the extension
                if (extensionImageMap[extension]) {
                    preview.src = extensionImageMap[extension];
                } else {
                    // If no specific image found, display a default image
                    preview.src = '/static/assets/img/icons/extensions/1x/default.png';
                }
            }
        }

        function enableButtons() {
            const cancelButton = document.getElementById("cancelButton");
            const uploadButton = document.getElementById("uploadButton");

            cancelButton.removeAttribute("disabled");
            uploadButton.removeAttribute("disabled");
        }

        function enableButtonsFile() {
            const cancelButton = document.getElementById("cancelButtonFile");
            const uploadButton = document.getElementById("uploadButtonFile");

            cancelButton.removeAttribute("disabled");
            uploadButton.removeAttribute("disabled");
        }

        function enableSubmitTaskButton() {
            const cancelButton = document.getElementById("cancelTaskButton");
            const uploadButton = document.getElementById("submitTaskButton");

            cancelButton.removeAttribute("disabled");
            uploadButton.removeAttribute("disabled");
        }

        function disableButtons() {
            const cancelButton = document.getElementById("cancelButton");
            const uploadButton = document.getElementById("uploadButton");

            cancelButton.setAttribute("disabled", "disabled");
            uploadButton.setAttribute("disabled", "disabled");
        }

        function disableButtonsFile() {
            const cancelButton = document.getElementById("cancelButtonFile");
            const uploadButton = document.getElementById("uploadButtonFile");

            cancelButton.setAttribute("disabled", "disabled");
            uploadButton.setAttribute("disabled", "disabled");
        }

        function disableSubmitTaskButton() {
            const cancelButton = document.getElementById("cancelTaskButton");
            const uploadButton = document.getElementById("submitTaskButton");

            cancelButton.setAttribute("disabled", "disabled");
            uploadButton.setAttribute("disabled", "disabled");
        }

        function updateCategory(event) {
            const fileInput = event.target;
            const fileTypeSelect = document.getElementById('fileCategoryInput');

            // Get the selected file
            const selectedFile = fileInput.files[0];

            if (selectedFile) {
                // Get the file name and split it to extract the extension
                const fileName = selectedFile.name;
                const fileExtension = fileName.split('.').pop().toLowerCase();

                // Map file extensions to categories (customize this as needed)
                const extensionToCategory = {
                    'rvt': '3d-models',
                    'stp': '3d-models',
                    'igs': '3d-models',
                    'ifc': '3d-models',
                    'sat': '3d-models',
                    'dxf': '3d-models',
                    'dwg': '3d-models',
                    'prt': '3d-models',
                    'catpart': '3d-models',
                    'catproduct': '3d-models',
                    'cgr': '3d-models',
                    'obj': '3d-models',
                    'stl': '3d-models',
                    'jt': '3d-models',
                    'dgn': '3d-models',
                    'fbx': '3d-models',
                    'sldprt': '3d-models',
                    'sldasm': '3d-models',
                    'rcp': 'clouds',
                    'rcs': 'clouds',
                    'pod': 'clouds',
                    'fls': 'clouds',
                    'las': 'clouds',
                    'e57': 'clouds',
                    'py': 'scripts',
                    'html': 'scripts',
                    'css': 'scripts',
                    'js': 'scripts',
                    'cs': 'scripts',
                    'c': 'scripts',
                    'cpp': 'scripts',
                    'json': 'scripts',
                    'xml': 'scripts',
                    'kt': 'scripts',
                    'kts': 'scripts',
                    'exe': 'executable',
                    'zip': 'folders',
                    'rar': 'folders',
                    'assets': 'unity',
                    'asset': 'unity',
                    'ress': 'unity',
                    'sqlite3': 'database',
                    'xlsx': 'office',
                    'docx': 'office',
                    'pptx': 'office',
                    'pdf': 'office',
                    'ai': 'images',
                    'jpg': 'images',
                    'jpeg': 'images',
                    'png': 'images',
                    'gif': 'images',
                    'webp': 'images',
                    'ico': 'images',
                    'mp4': 'video',
                    'avi': 'video',
                    'mkv': 'video',
                    'wmv': 'video',
                    'txt': 'office',
                    'x_t': '3d-models',
                    'x_b': '3d-models',
                    'apk': 'executable',
                    // Add more mappings here
                };

                // Update the select field based on the file extension
                if (extensionToCategory[fileExtension]) {
                    fileTypeSelect.value = extensionToCategory[fileExtension];
                } else {
                    fileTypeSelect.value = 'other'; // Default to "Other" if no mapping found
                }
            }
        }

        function submitCheckboxForm(taskId) {
            const formId = 'changeStatusTask' + taskId;
            document.getElementById(formId).submit();
        }

    </script>

    <script>

        $(document).ready(function () {
            const valueInput = $("#fileValueInput");

            valueInput.on("blur", function () {
                let inputValue = valueInput.val();

                inputValue = inputValue.replace(/[$, ]/g, '');
                inputValue = inputValue.replace(/,/g, '.');

                valueInput.val(inputValue);
            });

            valueInput.inputmask({
                alias: "numeric",
                radixPoint: ".",
                groupSeparator: ",",
                autoGroup: true,
                rightAlign: false,
                autoUnmask: true,
                numericInput: true,
                prefix: "USD ",
            });
        });

    </script>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let tagsInput = document.getElementById('choices-collaborators');

            let choices = new Choices(tagsInput, {
                removeItemButton: true,
                maxItemCount: 20,
            });
        });
    </script>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Get the task ID from the fragment identifier in the URL
            let taskId = window.location.hash.substring(5); // Assuming 'task' has length 12
    
            // If the task ID is not empty, trigger the modal
            if (taskId) {
                let modal = document.getElementById('taskDetails' + taskId);
                let bsModal = new bootstrap.Modal(modal);
                bsModal.show();
            }
        });
    </script>

{% endblock javascripts %}


